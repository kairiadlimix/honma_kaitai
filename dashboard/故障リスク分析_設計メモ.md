# 故障リスク分析 - 設計メモ

## 📋 現状確認

### 既に実装されているもの
- ✅ 故障リスクスコア（1-5）の計算ロジック
  - メンテナンス頻度から計算
  - `MachineSummary`に含まれている
- ✅ 全社サマリーに「故障リスクが高い重機」の件数表示

### 未実装
- ❌ 故障リスク分析ページ（現在はプレースホルダーのみ）

---

## 🎯 要件定義から

### 必要な機能
1. **故障リスクランキング**
   - 故障リスクスコアが高い重機TOP10
   - 各重機のリスク要因（不調項目数、メンテ頻度など）

2. **故障傾向分析**
   - 重機クラス別の故障発生率
   - メーカー別の故障発生率
   - 年式別の故障発生率
   - 不調チェック項目の出現頻度

3. **要注意重機リスト**
   - 故障リスクスコアが4以上（★4〜5）の重機一覧
   - 各重機の推奨アクション（整備推奨、買い替え検討など）

---

## 💭 壁打ち：考えたいポイント

### 1. 故障リスクスコアの計算方法
**現在**: メンテナンス頻度のみ
**検討事項**:
- 他に考慮すべき要素は？
  - 累計稼働時間（使用年数）
  - 年式（古いほどリスク高？）
  - 稼働率（低いとリスク高？高いとリスク高？）
  - メンテナンス間隔（長いとリスク高？）
  - 不調チェック項目の数
  - コスト（高いとリスク高？）

### 2. リスク要因の表示
**表示したい情報**:
- メンテナンス頻度（過去6ヶ月で何回？）
- 累計稼働時間
- 年式
- 最終メンテナンスからの経過日数
- その他？

### 3. 故障傾向分析の粒度
**分析軸**:
- 重機クラス別（SK235、ZX200など）
- メーカー別（コベルコ、日立）
- 年式別（2016年、2017年など）
- 組み合わせ（例：コベルコのSK235）

**表示方法**:
- 棒グラフ？
- テーブル？
- ヒートマップ？

### 4. 推奨アクション
**アクションの種類**:
- 整備推奨
- 買い替え検討
- 使用頻度の見直し
- 定期点検の強化
- その他？

**判断基準**:
- リスクスコアだけで判断？
- 年式や累計稼働時間も考慮？

### 5. 不調チェック項目
**現状**: データ構造に含まれていない
**検討事項**:
- 不調チェック項目のデータが必要？
- どのような項目を想定？
  - エンジン不調
  - 油圧系統の異常
  - 走行系統の異常
  - その他？

---

## 🎨 UI/UXの検討

### ページ構成案

#### 案1: シンプル構成
1. 故障リスクランキング（TOP10）
2. 要注意重機リスト（リスク4以上）
3. 故障傾向分析（グラフ）

#### 案2: 詳細構成
1. サマリーカード（リスク4以上の台数、平均リスクスコアなど）
2. 故障リスクランキング（全重機、ソート可能）
3. 要注意重機リスト（詳細情報付き）
4. 故障傾向分析（複数のグラフ）
5. 推奨アクション一覧

### グラフの種類
- リスクスコア分布（ヒストグラム）
- 重機クラス別平均リスクスコア（棒グラフ）
- メーカー別平均リスクスコア（棒グラフ）
- 年式別平均リスクスコア（折れ線グラフ）
- リスクスコア推移（時系列、将来拡張）

---

## ❓ 質問・検討事項

1. **リスクスコアの計算方法**
   - 現在のメンテナンス頻度ベースで良い？
   - 他の要素も追加したい？

2. **リスク要因の表示**
   - 何を表示すべき？
   - どのように表示する？（カード、テーブル、グラフ）

3. **故障傾向分析**
   - どの分析が最も重要？
   - どのようなグラフが分かりやすい？

4. **推奨アクション**
   - どのようなアクションを表示したい？
   - 判断基準は？

5. **優先順位**
   - まず何から実装したい？
   - PoCで最低限必要な機能は？

---

## 📝 次のステップ

1. 上記の質問に答えて、要件を明確化
2. データ構造の設計
3. モックデータの拡張
4. UIコンポーネントの実装
5. APIエンドポイントの実装

