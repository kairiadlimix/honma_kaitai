# 開発環境セットアップガイド

## 1. 必要なツールのインストール

### 1.1 Node.js

**推奨バージョン**: Node.js 18+ (LTS)

**インストール方法**:

**macOS (Homebrew)**:
```bash
brew install node@18
```

**または nvm を使用**:
```bash
# nvmのインストール
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Node.js 18のインストール
nvm install 18
nvm use 18
```

**確認**:
```bash
node --version  # v18.x.x 以上
npm --version   # 9.x.x 以上
```

---

### 1.2 pnpm

**インストール**:
```bash
npm install -g pnpm
```

**確認**:
```bash
pnpm --version
```

---

### 1.3 PostgreSQL

**macOS (Homebrew)**:
```bash
brew install postgresql@15
brew services start postgresql@15
```

**確認**:
```bash
psql --version
```

**データベース作成**:
```bash
createdb honma_kaitai_dev
```

---

### 1.4 Git

**確認**:
```bash
git --version
```

**未インストールの場合 (macOS)**:
```bash
# Xcode Command Line Toolsをインストール
xcode-select --install
```

---

## 2. プロジェクトのセットアップ

### 2.1 プロジェクトディレクトリの作成

```bash
cd /Users/kairi.oshima/honma_kaitai
mkdir dashboard
cd dashboard
```

### 2.2 Next.jsプロジェクトの作成

```bash
pnpm create next-app@latest . --typescript --tailwind --app --no-src-dir --import-alias "@/*"
```

**選択肢**:
- TypeScript: Yes
- ESLint: Yes
- Tailwind CSS: Yes
- `src/` directory: No
- App Router: Yes
- Import alias: `@/*`

### 2.3 必要なパッケージのインストール

```bash
# UI関連
pnpm add @radix-ui/react-slot class-variance-authority clsx tailwind-merge
pnpm add lucide-react

# グラフ
pnpm add recharts

# 状態管理
pnpm add @tanstack/react-query zustand

# フォーム
pnpm add react-hook-form zod @hookform/resolvers

# 日付処理
pnpm add date-fns

# Prisma
pnpm add -D prisma
pnpm add @prisma/client

# kintone連携
pnpm add @kintone/rest-api-client

# その他
pnpm add date-fns
```

### 2.4 Prismaの初期化

```bash
pnpm prisma init
```

### 2.5 shadcn/uiのセットアップ

```bash
pnpm dlx shadcn-ui@latest init
```

**選択肢**:
- Would you like to use TypeScript: Yes
- Which style would you like to use: Default
- Which color would you like to use as base color: Slate
- Where is your global CSS file: app/globals.css
- Would you like to use CSS variables: Yes
- Where is your tailwind.config.js: tailwind.config.ts
- Configure the import alias for components: @/components
- Configure the import alias for utils: @/lib/utils

---

## 3. 環境変数の設定

### 3.1 .env.localファイルの作成

プロジェクトルートに `.env.local` を作成:

```env
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/honma_kaitai_dev"

# kintone (将来使用)
KINTONE_BASE_URL="https://your-domain.cybozu.com"
KINTONE_API_TOKEN="your-api-token"

# Next.js
NEXT_PUBLIC_APP_URL="http://localhost:3000"
```

### 3.2 .env.exampleファイルの作成

`.env.example` を作成（コミット対象）:

```env
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/honma_kaitai_dev"

# kintone
KINTONE_BASE_URL=""
KINTONE_API_TOKEN=""

# Next.js
NEXT_PUBLIC_APP_URL="http://localhost:3000"
```

---

## 4. プロジェクト構造の作成

以下のディレクトリ構造を作成:

```
dashboard/
├── app/
│   ├── (dashboard)/
│   │   ├── machines/
│   │   │   ├── [id]/
│   │   │   └── page.tsx
│   │   ├── risk-analysis/
│   │   ├── rankings/
│   │   ├── consumables/
│   │   ├── cost-analysis/
│   │   └── page.tsx
│   ├── api/
│   │   ├── machines/
│   │   ├── operations/
│   │   ├── maintenances/
│   │   └── consumables/
│   ├── layout.tsx
│   └── globals.css
├── components/
│   ├── ui/          # shadcn/uiコンポーネント
│   ├── dashboard/   # ダッシュボード専用コンポーネント
│   ├── charts/      # グラフコンポーネント
│   └── layout/      # レイアウトコンポーネント
├── lib/
│   ├── prisma.ts    # Prismaクライアント
│   ├── utils.ts     # ユーティリティ関数
│   └── kintone.ts   # kintone連携
├── prisma/
│   ├── schema.prisma
│   └── migrations/
├── public/
└── types/
```

---

## 5. 開発サーバーの起動

```bash
# 開発サーバー起動
pnpm dev
```

ブラウザで `http://localhost:3000` を開く

---

## 6. VS Code拡張機能（推奨）

以下の拡張機能をインストール:

- **ESLint**: コード品質チェック
- **Prettier**: コードフォーマット
- **Prisma**: Prisma構文ハイライト
- **Tailwind CSS IntelliSense**: Tailwind CSS補完
- **TypeScript and JavaScript Language Features**: TypeScriptサポート

---

## 7. トラブルシューティング

### 7.1 Node.jsが見つからない

```bash
# nvmを使用している場合
nvm use 18

# PATHの確認
echo $PATH
```

### 7.2 PostgreSQL接続エラー

```bash
# PostgreSQLの起動確認
brew services list | grep postgresql

# 起動していない場合
brew services start postgresql@15

# データベースの確認
psql -l
```

### 7.3 pnpmコマンドが見つからない

```bash
# グローバルインストール
npm install -g pnpm

# PATHの確認
which pnpm
```

---

## 8. 次のステップ

1. ✅ 開発環境のセットアップ完了
2. ⏭️ Prismaスキーマの定義
3. ⏭️ データベースマイグレーション
4. ⏭️ APIエンドポイントの実装
5. ⏭️ フロントエンドコンポーネントの実装

